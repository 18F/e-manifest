{
    "swagger": "2.0",
    "info": {
        "title": "e-Manifest API Documentation | US EPA",
        "description": "Endpoints for the e-Manifest application programming interfaces (API).",
        "version": "0.1"
    },
    "basePath": "/api/0.1",
    "produces": [
        "application/json"
    ],
    "paths": {
        "/manifest/submit/:manifest_tracking_number": {
            "post": {
                "summary": "Submit Manifest",
                "description": "Submit a new manifest to the eManifest system.",
                "parameters": [
                    {
                        "name": "manifest_tracking_number",
                        "in": "path",
                        "description": "the tracking number from Line 4 of form 8700-22",
                        "required": true,
                        "type": "string"
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "201": {
                        "description": "Successful creation of e-Manifest. The Location header denotes the manifest URL (e.g. `/api/0.1/manifest/id/:e_manifest_id`)."
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/id/:e_manifest_id": {
            "patch": {
                "consumes": "application/json-patch+json",
                "summary": "Update manifest by e-Manifest ID",
                "description": "Update a manifest previously submitted to the e-Manifest system; it does not change\nwhat has been signed. To re-sign, authenticate and sign the manifest again.\n<br>\nSee JSON Patch (http://tools.ietf.org/html/rfc6902) \nand JSON Pointer (http://tools.ietf.org/html/rfc6901) specifications.\n```\n{\"op\": \"replace\", \"path\": \"/generator/name\", \"value\": \"Generator ZZ\"},\n{\"op\": \"add\", \"path\": \"/generator/mailing_address/zip_code\", \"value\": \"11211\"},\n{\"op\": \"remove\", \"path\": \"/manifest_items/1\"},\n{\"op\": \"replace\", \"path\": \"/non_hazardous_material_present\", \"value\": \"no\"},\n{\"op\": \"add\", \"path\": \"/transporters\", \"value\": {\n    \"company_name\": \"AAAA Transporter\",\n    \"us_epa_id_number\": \"3882\",\n    \"signatory\": {\n      \"name\": \"John Smith\",\n      \"month\": \"10\",\n      \"day\": \"28\",\n      \"year\": \"2015\"\n    }\n  }\n}\n```\n",
                "parameters": [
                    {
                        "name": "e_manifest_id",
                        "in": "path",
                        "description": "The unique identifier for the manifest in the e-Manifest system (not the Manifest Tracking Number from Line 4 of form 8700-22).",
                        "required": true,
                        "type": "string"
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successfully updated."
                    },
                    "404": {
                        "description": "The given e_manifest_id did not match an existing manifest."
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/:manifest_tracking_number": {
            "get": {
                "summary": "Get manifest by Manifest Tracking Number",
                "description": "Retrieve a manifest previously submitted to the e-Manifest system.",
                "parameters": [
                    {
                        "name": "manifest_tracking_number",
                        "in": "path",
                        "description": "the tracking number from Line 4 of form 8700-22",
                        "required": true,
                        "type": "string"
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successful retrieval of the e-Manifest."
                    },
                    "404": {
                        "description": "Not found. The :e-manifest_id did not match any record."
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/id/:manifest_tracking_number": {
            "patch": {
                "consumes": "application/json-patch+json",
                "summary": "Update manifest by Manifest Tracking Number",
                "description": "Update a manifest previously submitted to the e-Manifest system; it does not change\nwhat has been signed. To re-sign, authenticate and sign the manifest again.\n<br>\nSee JSON Patch (http://tools.ietf.org/html/rfc6902) \nand JSON Pointer (http://tools.ietf.org/html/rfc6901) specifications.\n```\n{\"op\": \"replace\", \"path\": \"/generator/name\", \"value\": \"Generator ZZ\"},\n{\"op\": \"add\", \"path\": \"/generator/mailing_address/zip_code\", \"value\": \"11211\"},\n{\"op\": \"remove\", \"path\": \"/manifest_items/1\"},\n{\"op\": \"replace\", \"path\": \"/non_hazardous_material_present\", \"value\": \"no\"},\n{\"op\": \"add\", \"path\": \"/transporters\", \"value\": {\n    \"company_name\": \"AAAA Transporter\",\n    \"us_epa_id_number\": \"3882\",\n    \"signatory\": {\n      \"name\": \"John Smith\",\n      \"month\": \"10\",\n      \"day\": \"28\",\n      \"year\": \"2015\"\n    }\n  }\n}\n```\n",
                "parameters": [
                    {
                        "name": "manifest_tracking_number",
                        "in": "path",
                        "description": "the tracking number from Line 4 of form 8700-22",
                        "required": true,
                        "type": "string"
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successfully updated."
                    },
                    "404": {
                        "description": "The given manifest_tracking_number did not match an existing manifest."
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/search": {
            "get": {
                "summary": "Search for manifests",
                "description": "Search for manifests matching provided criteria.",
                "parameters": [
                    {
                        "name": "q",
                        "in": "query",
                        "description": "search terms",
                        "required": false,
                        "type": "string"
                    },
                    {
                        "name": "aq",
                        "in": "query",
                        "description": "advanced search terms",
                        "required": false,
                        "type": "string"
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successful search. Does not indicate any non-zero number of results."
                    },
                    "400": {
                        "description": "Invalid request. Typically means missing the :q or :aq parameter."
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/user/authenticate": {
            "post": {
                "summary": "Authenticate a user",
                "description": "Authenticates a user with CDX's CROMERR services for signing a manifest.    Values in the response are needed to sign the manifest.",
                "parameters": [
                    {
                        "name": "credentials",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/Credentials"
                        }
                    }
                ],
                "tags": [
                    "users"
                ],
                "produces": [
                    "application/json"
                ],
                "responses": {
                    "200": {
                        "description": "Successful authentication",
                        "schema": {
                            "$ref": "#/definitions/Authentication"
                        }
                    },
                    "401": {
                        "description": "Authentication failed"
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/sign": {
            "post": {
                "summary": "Sign manifest using e-Manifest ID",
                "description": "Signs a specified manifest with CDX's CROMERR services.",
                "parameters": [
                    {
                        "name": "signature",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/eManifestSignature"
                        }
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successful signature",
                        "schema": {
                            "$ref": "#/definitions/Document"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/manifest/signByTrackingNumber": {
            "post": {
                "summary": "Sign manifest by Manifest Tracking Number",
                "description": "Signs a specified manifest with CDX's CROMERR services.",
                "parameters": [
                    {
                        "name": "signature",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/TrackingSignature"
                        }
                    }
                ],
                "tags": [
                    "manifests"
                ],
                "responses": {
                    "200": {
                        "description": "Successful signature",
                        "schema": {
                            "$ref": "#/definitions/Document"
                        }
                    },
                    "default": {
                        "description": "Unexpected error",
                        "schema": {
                            "$ref": "#/definitions/Error"
                        }
                    }
                }
            }
        },
        "/method_code": {
            "get": {
                "summary": "Management method codes",
                "description": "Retrieve the valid hazardous waste report management method codes.",
                "tags": [
                    "management methods"
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/MethodCode"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "MethodCode": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "string"
                },
                "category": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                }
            }
        },
        "Document": {
            "type": "object",
            "properties": {
                "document_id": {
                    "type": "string"
                }
            }
        },
        "Credentials": {
            "type": "object",
            "properties": {
                "user_id": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                }
            }
        },
        "Authentication": {
            "type": "object",
            "properties": {
                "token": {
                    "type": "string"
                },
                "activity_id": {
                    "type": "string"
                },
                "question": {
                    "type": "object",
                    "properties": {
                        "question_id": {
                            "type": "string"
                        },
                        "question_text": {
                            "type": "string"
                        }
                    }
                },
                "user_id": {
                    "type": "string"
                }
            }
        },
        "eManifestSignature": {
            "type": "object",
            "properties": {
                "activity_id": {
                    "type": "string"
                },
                "answer": {
                    "type": "string"
                },
                "id": {
                    "description": "e-Manifest ID",
                    "type": "string"
                },
                "question_id": {
                    "type": "string"
                },
                "token": {
                    "type": "string"
                },
                "user_id": {
                    "description": "CDX user id",
                    "type": "string"
                }
            }
        },
        "TrackingSignature": {
            "type": "object",
            "properties": {
                "activity_id": {
                    "type": "string"
                },
                "answer": {
                    "type": "string"
                },
                "manifest_tracking_number": {
                    "description": "Manifest Tracking Number",
                    "type": "string"
                },
                "question_id": {
                    "type": "string"
                },
                "token": {
                    "type": "string"
                },
                "user_id": {
                    "description": "CDX user id",
                    "type": "string"
                }
            }
        },
        "Error": {
            "type": "object",
            "properties": {
                "code": {
                    "type": "integer",
                    "format": "int32"
                },
                "message": {
                    "type": "string"
                },
                "fields": {
                    "type": "string"
                }
            }
        }
    }
}
